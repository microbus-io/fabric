---
# General
#
# host - The host name of the microservice
# description - A human-friendly description of the microservice
# integrationTests - Whether or not to generate integration tests (defaults to true)
general:
  host: http.ingress.sys
  description: The HTTP Ingress microservice relays incoming HTTP requests to the NATS bus.

# Config properties
#
# signature - Func() (val Type)
# description - Documentation
# default - A default value (defaults to empty)
# validation - A validation pattern
#   str ^[a-zA-Z0-9]+$
#   bool
#   int [0,60]
#   float [0.0,1.0)
#   dur (0s,24h]
#   set Red|Green|Blue
#   url
#   email
#   json
# callback - "true" to handle the change event (defaults to "false")
# secret - "true" to indicate a secret (defaults to "false")
configs:
  - signature: TimeBudget() (budget time.Duration)
    description: TimeBudget specifies the timeout for incoming requests.
    default: 20s
    validation: dur [1s,5m]
  - signature: Ports() (port string)
    description: Ports is a comma-separated list of HTTP ports on which to listen for incoming requests.
    default: 8080
    callback: true
  - signature: RequestMemoryLimit() (megaBytes int)
    description: RequestMemoryLimit is the memory capacity used to hold pending requests, in megabytes.
    default: 4096
    validation: int [1,]
  - signature: AllowedOrigins() (origins string)
    description: AllowedOrigins is a comma-separated list of CORS origins to allow requests from.
    default: "*"
    callback: true
  - signature: PortMappings() (mappings string)
    description: |
      PortMappings is a comma-separated list of mappings in the form x:y->z where x is the inbound
      HTTP port, y is the requested NATS port, and z is the port to serve.
      An incoming HTTP request https://ingresshost:x/servicehost:y/path is mapped to internal NATS
      request https://servicehost:z/path .
      Both x and y can be * to indicate all ports. Setting z to * indicates to serve the requested
      port y without change. Specific rules take precedence over * rules.
      The default mapping grants access to all internal ports via HTTP port 8080 but restricts
      HTTP ports 443 and 80 to only internal port 443.
    default: 8080:*->*, 443:*->443, 80:*->443
    callback: true
  - signature: RedirectRoot() (toURL string)
    description: |-
      RedirectRoot defines the internal URL to redirect requests to the root path.
      The URL must be fully qualified, for example, "https://home.service/welcome-page".

# Types
#
# name - All non-primitive types used in functions must be accounted for
# description - Documentation
# define - Define a new type with the specified fields (name: type)
# import - The package path of the imported type
types:
  # - name: DefinedType
  #   description:
  #   define:
  #     fieldName: Type
  # - name: ImportedType
  #   description:
  #   import: package/path/of/a/remote/type/ImportedType

# Functions
#
# signature - Func(name Type, name Type) (name Type, name Type, httpStatusCode int)
# description - Documentation
# path - The subscription path
#   (empty) - The function name in kebab-case
#   /path - Default port :443
#   /directory/ - All paths under the directory
#   :443/path
#   :443/... - Ellipsis denotes the function name in kebab-case
#   :443 - Root path
#   https://example.com:443/path
# queue - The subscription queue
#   default - Load balanced (default)
#   none - Pervasive
functions:
  # - signature:
  #   description:

# Event sources
#
# signature - OnFunc(name Type, name Type) (name Type, name Type, httpStatusCode int)
# description - Documentation
# path - The subscription path
#   (empty) - The function name in kebab-case
#   /path - Default port :417
#   /directory/ - All paths under the directory
#   :417/path
#   :417/... - Ellipsis denotes the function name in kebab-case
#   :417 - Root path
#   https://example.com:417/path
events:
  # - signature:
  #   description:

# Event sinks
#
# signature - OnFunc(name Type, name Type) (name Type, name Type, httpStatusCode int)
# description - Documentation
# event - The name of the event at the source (defaults to the function name)
# source - The package path of the microservice that is the source of the event
# forHost - For an event source with an overridden host name
# queue - The subscription queue
#   default - Load balanced (default)
#   none - Pervasive
sinks:
  # - signature:
  #   description:
  #   source: package/path/of/another/microservice

# Web handlers
#
# signature - Func()
# description - Documentation
# path - The subscription path
#   (empty) - The function name in kebab-case
#   /path - Default port :443
#   /directory/ - All paths under the directory
#   :443/path
#   :443/... - Ellipsis denotes the function name in kebab-case
#   :443 - Root path
#   https://example.com:443/path
# queue - The subscription queue
#   default - Load balanced (default)
#   none - Pervasive
webs:
  # - signature:
  #   description:

# Tickers
#
# signature - Func()
# description - Documentation
# interval - Duration between iterations (e.g. 15m)
# timeBudget - Duration to complete an iteration
tickers:
  # - signature:
  #   description:
  #   interval:

# Databases
#
# mysql - A name for the MySQL database
databases:
